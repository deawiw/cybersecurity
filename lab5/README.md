# –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∞—è —Ä–∞–±–æ—Ç–∞ 5
deawiw@yandex.ru

## –¶–µ–ª—å —Ä–∞–±–æ—Ç—ã

1.  –ü–æ–ª—É—á–∏—Ç—å –∑–Ω–∞–Ω–∏—è –æ –º–µ—Ç–æ–¥–∞—Ö –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è —Ä–∞–¥–∏–æ—ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω–æ–π –æ–±—Å—Ç–∞–Ω–æ–≤–∫–∏.
2.  –°–æ—Å—Ç–∞–≤–∏—Ç—å –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –æ –º–µ—Ö–∞–Ω–∏–∑–º–∞—Ö —Ä–∞–±–æ—Ç—ã Wi-Fi —Å–µ—Ç–µ–π –Ω–∞ –∫–∞–Ω–∞–ª—å–Ω–æ–º
    –∏ —Å–µ—Ç–µ–≤–æ–º —É—Ä–æ–≤–Ω–µ –º–æ–¥–µ–ª–∏ OSI.
3.  –ó–µ–∫—Ä–µ–ø–∏—Ç—å –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –Ω–∞–≤—ã–∫–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —è–∑—ã–∫–∞ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è R
    –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö
4.  –ó–∞–∫—Ä–µ–ø–∏—Ç—å –∑–Ω–∞–Ω–∏—è –æ—Å–Ω–æ–≤–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö —ç–∫–æ—Å–∏—Å—Ç–µ–º—ã
    tidyverse —è–∑—ã–∫–∞ R

## –ò—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ

1.  –ü—Ä–æ–≥—Ä–∞–º–º–Ω–æ–µ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏–µ macOS 14.0
2.  RStudio Desktop
3.  –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ç–æ—Ä —è–∑—ã–∫–∞ R 4.1

## –ü–ª–∞–Ω

1.  –ò–º–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ –¥–∞–Ω–Ω—ã–µ ‚Äì
    https://storage.yandexcloud.net/dataset.ctfsec/P2_wifi_data.csv
    –î–∞–Ω–Ω—ã–µ –±—ã–ª–∏ —Å–æ–±—Ä–∞–Ω—ã —Å –ø–æ–º–æ—â—å—é –∞–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä–∞ –±–µ—Å–ø—Ä–æ–≤–æ–¥–Ω–æ–≥–æ —Ç—Ä–∞—Ñ–∏–∫–∞
    airodump-ng
2.  –ü—Ä–∏–≤–µ—Å—Ç–∏ –¥–∞—Ç–∞—Å–µ—Ç—ã –≤ –≤–∏–¥ ‚Äú–∞–∫–∫—É—Ä–∞—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö‚Äù, –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å —Ç–∏–ø—ã
    —Å—Ç–æ–ª–±—Ü–æ–≤ –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å —Ç–∏–ø–æ–º –¥–∞–Ω–Ω—ã—Ö
3.  –ü—Ä–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –æ–±—â—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–∞–Ω–Ω—ã—Ö —Å –ø–æ–º–æ—â—å—é —Ñ—É–Ω–∫—Ü–∏–∏ glimpse()
4.  –ü—Ä–æ–∏–∑–≤–µ—Å—Ç–∏ –∞–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö.
5.  –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –Ω–µ–±–µ–∑–æ–ø–∞—Å–Ω—ã–µ —Ç–æ—á–∫–∏ –¥–æ—Å—Ç—É–ø–∞ (–±–µ–∑ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è ‚Äì OPN)
6.  –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—è –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–Ω–æ–≥–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
7.  –í—ã—è–≤–∏—Ç—å —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞, –∏—Å–ø–æ–ª—å–∑—É—é—â–∏–µ –ø–æ—Å–ª–µ–¥–Ω—é—é –≤–µ—Ä—Å–∏—é –ø—Ä–æ—Ç–æ–∫–æ–ª–∞
    —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è WPA3, –∏ –Ω–∞–∑–≤–∞–Ω–∏—è —Ç–æ—á–µ–∫ –¥–æ—Å—Ç—É–ø–∞, —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –Ω–∞ —ç—Ç–∏—Ö
    —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö
8.  –û—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å —Ç–æ—á–∫–∏ –¥–æ—Å—Ç—É–ø–∞ –ø–æ –∏–Ω—Ç–µ—Ä–≤–∞–ª—É –≤—Ä–µ–º–µ–Ω–∏, –≤ —Ç–µ—á–µ–Ω–∏–µ –∫–æ—Ç–æ—Ä–æ–≥–æ
    –æ–Ω–∏ –Ω–∞—Ö–æ–¥–∏–ª–∏—Å—å –Ω–∞ —Å–≤—è–∑–∏, –ø–æ —É–±—ã–≤–∞–Ω–∏—é.
9.  –û–±–Ω–∞—Ä—É–∂–∏—Ç—å —Ç–æ–ø-10 —Å–∞–º—ã—Ö –±—ã—Å—Ç—Ä—ã—Ö —Ç–æ—á–µ–∫ –¥–æ—Å—Ç—É–ø–∞.
10. –û—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å —Ç–æ—á–∫–∏ –¥–æ—Å—Ç—É–ø–∞ –ø–æ —á–∞—Å—Ç–æ—Ç–µ –æ—Ç–ø—Ä–∞–≤–∫–∏ –∑–∞–ø—Ä–æ—Å–æ–≤ (beacons) –≤
    –µ–¥–∏–Ω–∏—Ü—É –≤—Ä–µ–º–µ–Ω–∏ –ø–æ –∏—Ö —É–±—ã–≤–∞–Ω–∏—é. 11.–û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—è –¥–ª—è
    –∫–∞–∂–¥–æ–≥–æ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–Ω–æ–≥–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ (–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö
    –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª–µ–π –∏–∑ —Å–æ—Å—Ç–∞–≤–∞ Wireshark –∏–ª–∏ –æ–Ω–ª–∞–π–Ω —Å–µ—Ä–≤–∏—Å–∞–º–∏ OUI lookup)
11. –û–±–Ω–∞—Ä—É–∂–∏—Ç—å —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞, –∫–æ—Ç–æ—Ä—ã–µ –ù–ï —Ä–∞–Ω–¥–æ–º–∏–∑–∏—Ä—É—é—Ç —Å–≤–æ–π MAC –∞–¥—Ä–µ—Å
12. –ö–ª–∞—Å—Ç–µ—Ä–∏–∑–æ–≤–∞—Ç—å –∑–∞–ø—Ä–æ—Å—ã –æ—Ç —É—Å—Ç—Ä–æ–π—Å—Ç–≤ –∫ —Ç–æ—á–∫–∞–º –¥–æ—Å—Ç—É–ø–∞ –ø–æ –∏—Ö –∏–º–µ–Ω–∞–º.
    –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –≤—Ä–µ–º—è –ø–æ—è–≤–ª–µ–Ω–∏—è —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –≤ –∑–æ–Ω–µ —Ä–∞–¥–∏–æ–≤–∏–¥–∏–º–æ—Å—Ç–∏ –∏ –≤—Ä–µ–º—è
    –≤—ã—Ö–æ–¥–∞ –µ–≥–æ –∏–∑ –Ω–µ–µ.
13. –û—Ü–µ–Ω–∏—Ç—å —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å —É—Ä–æ–≤–Ω—è —Å–∏–≥–Ω–∞–ª–∞ –≤–Ω—É—Ä–∏ –∫–ª–∞—Å—Ç–µ—Ä–∞ –≤–æ –≤—Ä–µ–º–µ–Ω–∏.
    –í—ã—è–≤–∏—Ç—å –Ω–∞–∏–±–æ–ª–µ–µ —Å—Ç–∞–±–∏–ª—å–Ω—ã–π –∫–ª–∞—Å—Ç–µ—Ä.

## –®–∞–≥–∏:

1.  –ò–º–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ –¥–∞–Ω–Ω—ã–µ.

``` r
library(readr)
```

    Warning: package 'readr' was built under R version 4.5.2

``` r
library(dplyr)
```


    Attaching package: 'dplyr'

    The following objects are masked from 'package:stats':

        filter, lag

    The following objects are masked from 'package:base':

        intersect, setdiff, setequal, union

``` r
library(lubridate)
```


    Attaching package: 'lubridate'

    The following objects are masked from 'package:base':

        date, intersect, setdiff, union

``` r
library(stringr)
wifi_raw <- read_csv("https://storage.yandexcloud.net/dataset.ctfsec/P2_wifi_data.csv")
```

    Warning: One or more parsing issues, call `problems()` on your data frame for details,
    e.g.:
      dat <- vroom(...)
      problems(dat)

    Rows: 12249 Columns: 15

    ‚îÄ‚îÄ Column specification ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    Delimiter: ","
    chr  (10): BSSID, Privacy, Cipher, Authentication, Power, # beacons, # IV, L...
    dbl   (2): channel, Speed
    lgl   (1): Key
    dttm  (2): First time seen, Last time seen

    ‚Ñπ Use `spec()` to retrieve the full column specification for this data.
    ‚Ñπ Specify the column types or set `show_col_types = FALSE` to quiet this message.

1.  –ü—Ä–∏–≤–µ—Å—Ç–∏ –¥–∞—Ç–∞—Å–µ—Ç—ã –≤ –≤–∏–¥ ‚Äú–∞–∫–∫—É—Ä–∞—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö‚Äù, –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å —Ç–∏–ø—ã
    —Å—Ç–æ–ª–±—Ü–æ–≤ –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å —Ç–∏–ø–æ–º –¥–∞–Ω–Ω—ã—Ö

``` r
wifi_clean <- wifi_raw %>%
  mutate(
    `First time seen` = ymd_hms(`First time seen`),
    `Last time seen` = ymd_hms(`Last time seen`),
    channel = as.integer(channel),
    Speed = as.integer(Speed)
  ) %>%
  filter(!is.na(`First time seen`), !is.na(`Last time seen`))
```

1.  –ü—Ä–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –æ–±—â—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–∞–Ω–Ω—ã—Ö —Å –ø–æ–º–æ—â—å—é —Ñ—É–Ω–∫—Ü–∏–∏ glimpse()

``` r
glimpse(wifi_clean)
```

    Rows: 12,248
    Columns: 15
    $ BSSID             <chr> "BE:F1:71:D5:17:8B", "6E:C7:EC:16:DA:1A", "9A:75:A8:‚Ä¶
    $ `First time seen` <dttm> 2023-07-28 09:13:03, 2023-07-28 09:13:03, 2023-07-2‚Ä¶
    $ `Last time seen`  <dttm> 2023-07-28 11:50:50, 2023-07-28 11:55:12, 2023-07-2‚Ä¶
    $ channel           <int> 1, 1, 1, 7, 6, 6, 11, 11, 11, 1, 6, 14, 11, 11, 6, 6‚Ä¶
    $ Speed             <int> 195, 130, 360, 360, 130, 130, 195, 130, 130, 195, 18‚Ä¶
    $ Privacy           <chr> "WPA2", "WPA2", "WPA2", "WPA2", "WPA2", "OPN", "WPA2‚Ä¶
    $ Cipher            <chr> "CCMP", "CCMP", "CCMP", "CCMP", "CCMP", NA, "CCMP", ‚Ä¶
    $ Authentication    <chr> "PSK", "PSK", "PSK", "PSK", "PSK", NA, "PSK", "PSK",‚Ä¶
    $ Power             <chr> "-30", "-30", "-68", "-37", "-57", "-63", "-27", "-3‚Ä¶
    $ `# beacons`       <chr> "846", "750", "694", "510", "647", "251", "1647", "1‚Ä¶
    $ `# IV`            <chr> "504", "116", "26", "21", "6", "3430", "80", "11", "‚Ä¶
    $ `LAN IP`          <chr> "0.  0.  0.  0", "0.  0.  0.  0", "0.  0.  0.  0", "‚Ä¶
    $ `ID-length`       <chr> "12", "4", "2", "14", "25", "13", "12", "13", "24", ‚Ä¶
    $ ESSID             <chr> "C322U13 3965", "Cnet", "KC", "POCO X5 Pro 5G", NA, ‚Ä¶
    $ Key               <lgl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, ‚Ä¶

1.  –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –Ω–µ–±–µ–∑–æ–ø–∞—Å–Ω—ã–µ —Ç–æ—á–∫–∏ –¥–æ—Å—Ç—É–ø–∞ (–±–µ–∑ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è ‚Äì OPN)

``` r
insecure_ap <- wifi_clean %>%
  filter(Privacy == "OPN")

insecure_ap
```

    # A tibble: 42 √ó 15
       BSSID    `First time seen`   `Last time seen`    channel Speed Privacy Cipher
       <chr>    <dttm>              <dttm>                <int> <int> <chr>   <chr> 
     1 E8:28:C‚Ä¶ 2023-07-28 09:13:03 2023-07-28 11:55:38       6   130 OPN     <NA>  
     2 E8:28:C‚Ä¶ 2023-07-28 09:13:06 2023-07-28 11:55:12       6   130 OPN     <NA>  
     3 E8:28:C‚Ä¶ 2023-07-28 09:13:06 2023-07-28 11:55:11       6   130 OPN     <NA>  
     4 E8:28:C‚Ä¶ 2023-07-28 09:13:06 2023-07-28 11:55:10       6    -1 OPN     <NA>  
     5 00:25:0‚Ä¶ 2023-07-28 09:13:06 2023-07-28 11:56:21      44    -1 OPN     <NA>  
     6 E8:28:C‚Ä¶ 2023-07-28 09:13:09 2023-07-28 11:56:05      11   130 OPN     <NA>  
     7 E8:28:C‚Ä¶ 2023-07-28 09:13:13 2023-07-28 10:27:06       6   130 OPN     <NA>  
     8 E8:28:C‚Ä¶ 2023-07-28 09:13:13 2023-07-28 10:39:43       6   130 OPN     <NA>  
     9 E8:28:C‚Ä¶ 2023-07-28 09:13:17 2023-07-28 11:52:32       1   130 OPN     <NA>  
    10 E8:28:C‚Ä¶ 2023-07-28 09:13:50 2023-07-28 11:43:39      11   130 OPN     <NA>  
    # ‚Ñπ 32 more rows
    # ‚Ñπ 8 more variables: Authentication <chr>, Power <chr>, `# beacons` <chr>,
    #   `# IV` <chr>, `LAN IP` <chr>, `ID-length` <chr>, ESSID <chr>, Key <lgl>

``` r
nrow(insecure_ap)
```

    [1] 42

1.  –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—è –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–Ω–æ–≥–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞

``` r
get_manufacturer <- function(mac) {
  oui <- str_sub(mac, 1, 8)
  case_when(
    oui == "00:25:00" ~ "Dell",
    oui == "00:14:22" ~ "D-Link",
    oui == "00:23:69" ~ "Apple",
    oui == "00:26:BB" ~ "Cisco",
    oui == "08:00:27" ~ "VirtualBox",
    TRUE ~ "Unknown"
  )
}

wifi_clean <- wifi_clean %>%
  mutate(Manufacturer = get_manufacturer(BSSID))

count(wifi_clean, Manufacturer, sort = TRUE)
```

    # A tibble: 2 √ó 2
      Manufacturer     n
      <chr>        <int>
    1 Unknown      12247
    2 Dell             1

1.  –í—ã—è–≤–∏—Ç—å —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞, –∏—Å–ø–æ–ª—å–∑—É—é—â–∏–µ –ø–æ—Å–ª–µ–¥–Ω—é—é –≤–µ—Ä—Å–∏—é –ø—Ä–æ—Ç–æ–∫–æ–ª–∞
    —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è WPA3, –∏ –Ω–∞–∑–≤–∞–Ω–∏—è —Ç–æ—á–µ–∫ –¥–æ—Å—Ç—É–ø–∞, —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –Ω–∞ —ç—Ç–∏—Ö
    —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö

``` r
wifi_clean %>%
  filter(str_detect(Privacy, "WPA3") | str_detect(Authentication, "WPA3")) %>%
  select(BSSID, ESSID, Privacy, Authentication)
```

    # A tibble: 8 √ó 4
      BSSID             ESSID                Privacy   Authentication
      <chr>             <chr>                <chr>     <chr>         
    1 26:20:53:0C:98:E8 <NA>                 WPA3 WPA2 SAE PSK       
    2 A2:FE:FF:B8:9B:C9 Christie‚Äôs           WPA3 WPA2 SAE PSK       
    3 96:FF:FC:91:EF:64 <NA>                 WPA3 WPA2 SAE PSK       
    4 CE:48:E7:86:4E:33 iPhone (–ê–Ω–∞—Å—Ç–∞—Å–∏—è)   WPA3 WPA2 SAE PSK       
    5 8E:1F:94:96:DA:FD iPhone (–ê–Ω–∞—Å—Ç–∞—Å–∏—è)   WPA3 WPA2 SAE PSK       
    6 BE:FD:EF:18:92:44 –î–∏–º–∞—Å–∏–∫              WPA3 WPA2 SAE PSK       
    7 3A:DA:00:F9:0C:02 iPhone XS Max ü¶äüê±ü¶ä WPA3 WPA2 SAE PSK       
    8 76:C5:A0:70:08:96 <NA>                 WPA3 WPA2 SAE PSK       

1.  –û—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å —Ç–æ—á–∫–∏ –¥–æ—Å—Ç—É–ø–∞ –ø–æ –∏–Ω—Ç–µ—Ä–≤–∞–ª—É –≤—Ä–µ–º–µ–Ω–∏, –≤ —Ç–µ—á–µ–Ω–∏–µ –∫–æ—Ç–æ—Ä–æ–≥–æ
    –æ–Ω–∏ –Ω–∞—Ö–æ–¥–∏–ª–∏—Å—å –Ω–∞ —Å–≤—è–∑–∏, –ø–æ —É–±—ã–≤–∞–Ω–∏—é.

``` r
wifi_clean %>%
  mutate(duration_min = as.numeric(difftime(`Last time seen`, `First time seen`, units = "mins"))) %>%
  arrange(desc(duration_min)) %>%
  select(BSSID, ESSID, duration_min)
```

    # A tibble: 12,248 √ó 3
       BSSID             ESSID         duration_min
       <chr>             <chr>                <dbl>
     1 00:25:00:FF:94:73 <NA>                  163.
     2 10:51:07:CB:33:BF <NA>                  163.
     3 00:95:69:E7:7C:ED <NA>                  163.
     4 00:95:69:E7:7D:21 <NA>                  163.
     5 10:51:07:CB:33:E7 <NA>                  163.
     6 8C:55:4A:DE:F2:38 <NA>                  163.
     7 E8:28:C1:DD:04:52 MIREA_HOTSPOT         163.
     8 00:95:69:E7:7F:35 <NA>                  163.
     9 E8:28:C1:DC:B2:52 MIREA_HOTSPOT         163.
    10 BC:F1:71:D5:3F:C7 <NA>                  163.
    # ‚Ñπ 12,238 more rows

1.  –û–±–Ω–∞—Ä—É–∂–∏—Ç—å —Ç–æ–ø-10 —Å–∞–º—ã—Ö –±—ã—Å—Ç—Ä—ã—Ö —Ç–æ—á–µ–∫ –¥–æ—Å—Ç—É–ø–∞.

``` r
wifi_clean %>%
  arrange(desc(Speed)) %>%
  select(BSSID, ESSID, Speed) %>%
  head(10)
```

    # A tibble: 10 √ó 3
       BSSID             ESSID Speed
       <chr>             <chr> <int>
     1 00:95:69:E7:7D:21 <NA>   8171
     2 00:95:69:E7:7C:ED <NA>   4096
     3 00:95:69:E7:7F:35 <NA>   2245
     4 98:F6:21:72:9E:D6 <NA>   2143
     5 F6:4D:98:98:18:C3 <NA>   1062
     6 52:FE:C5:8B:DF:D3 <NA>   1037
     7 C0:E4:34:D8:E7:E5 <NA>    958
     8 74:DF:BF:7B:00:19 <NA>    911
     9 26:20:53:0C:98:E8 <NA>    866
    10 96:FF:FC:91:EF:64 <NA>    866

1.  –û—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å —Ç–æ—á–∫–∏ –¥–æ—Å—Ç—É–ø–∞ –ø–æ —á–∞—Å—Ç–æ—Ç–µ –æ—Ç–ø—Ä–∞–≤–∫–∏ –∑–∞–ø—Ä–æ—Å–æ–≤ (beacons) –≤
    –µ–¥–∏–Ω–∏—Ü—É –≤—Ä–µ–º–µ–Ω–∏ –ø–æ –∏—Ö —É–±—ã–≤–∞–Ω–∏—é

``` r
wifi_clean %>%
  mutate(
    beacons = as.numeric(`# beacons`),
    duration_min = as.numeric(difftime(`Last time seen`, `First time seen`, units = "mins")),
    beacon_rate = beacons / duration_min
  ) %>%
  filter(!is.na(beacon_rate), duration_min > 0) %>%
  arrange(desc(beacon_rate)) %>%
  select(BSSID, ESSID, beacon_rate)
```

    Warning: There was 1 warning in `mutate()`.
    ‚Ñπ In argument: `beacons = as.numeric(`# beacons`)`.
    Caused by warning:
    ! NAs introduced by coercion

    # A tibble: 124 √ó 3
       BSSID             ESSID                    beacon_rate
       <chr>             <chr>                          <dbl>
     1 F2:30:AB:E9:03:ED iPhone (Uliana)                51.4 
     2 B2:CF:C0:00:4A:60 –ú–∏—Ö–∞–∏–ª's Galaxy M32            48   
     3 3A:DA:00:F9:0C:02 iPhone XS Max ü¶äüê±ü¶ä           33.3 
     4 02:BC:15:7E:D5:DC MT_FREE                        30   
     5 00:3E:1A:5D:14:45 MT_FREE                        30   
     6 76:C5:A0:70:08:96 <NA>                           30   
     7 D2:25:91:F6:6C:D8 –°–∞–Ω—è                           23.1 
     8 BE:F1:71:D6:10:D7 C322U21 0566                   10.4 
     9 00:03:7A:1A:03:56 MT_FREE                        10   
    10 38:1A:52:0D:84:D7 EBFCD57F-EE81fI_DL_1AO2T        9.78
    # ‚Ñπ 114 more rows

1.  –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—è –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–Ω–æ–≥–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞

``` r
get_manufacturer <- function(mac) {
  oui <- str_sub(mac, 1, 8)
  case_when(
    oui == "00:25:00" ~ "Dell",
    oui == "00:14:22" ~ "D-Link",
    oui == "00:23:69" ~ "Apple",
    oui == "00:26:BB" ~ "Cisco",
    oui == "08:00:27" ~ "VirtualBox",
    TRUE ~ "Unknown"
  )
}

wifi_clean <- wifi_clean %>%
  mutate(Manufacturer = get_manufacturer(BSSID))

count(wifi_clean, Manufacturer, sort = TRUE)
```

    # A tibble: 2 √ó 2
      Manufacturer     n
      <chr>        <int>
    1 Unknown      12247
    2 Dell             1

1.  –û–±–Ω–∞—Ä—É–∂–∏—Ç—å —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞, –∫–æ—Ç–æ—Ä—ã–µ –ù–ï —Ä–∞–Ω–¥–æ–º–∏–∑–∏—Ä—É—é—Ç —Å–≤–æ–π MAC –∞–¥—Ä–µ—Å

``` r
is_randomized_mac <- function(mac) {
  first_byte <- str_sub(mac, 1, 2)
  first_byte_dec <- strtoi(first_byte, base = 16)
  bitwAnd(first_byte_dec, 2) == 2
}

wifi_clean <- wifi_clean %>%
  mutate(
    is_randomized = is_randomized_mac(BSSID)
  )

non_random_devices <- wifi_clean %>%
  filter(!is_randomized)

nrow(non_random_devices)
```

    [1] 313

1.  –ö–ª–∞—Å—Ç–µ—Ä–∏–∑–æ–≤–∞—Ç—å –∑–∞–ø—Ä–æ—Å—ã –æ—Ç —É—Å—Ç—Ä–æ–π—Å—Ç–≤ –∫ —Ç–æ—á–∫–∞–º –¥–æ—Å—Ç—É–ø–∞ –ø–æ –∏—Ö –∏–º–µ–Ω–∞–º.
    –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –≤—Ä–µ–º—è –ø–æ—è–≤–ª–µ–Ω–∏—è —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –≤ –∑–æ–Ω–µ —Ä–∞–¥–∏–æ–≤–∏–¥–∏–º–æ—Å—Ç–∏ –∏ –≤—Ä–µ–º—è
    –≤—ã—Ö–æ–¥–∞ –µ–≥–æ –∏–∑ –Ω–µ–µ.

``` r
clusters <- wifi_clean %>%
  filter(!is.na(ESSID)) %>%
  group_by(ESSID) %>%
  summarise(
    first_seen = min(`First time seen`),
    last_seen = max(`Last time seen`),
    duration_min = as.numeric(difftime(last_seen, first_seen, units = "mins")),
    ap_count = n(),
    .groups = "drop"
  )

glimpse(clusters)
```

    Rows: 64
    Columns: 5
    $ ESSID        <chr> "Amuler", "AndroidAP177B", "C239U51 0701", "C239U52 6706"‚Ä¶
    $ first_seen   <dttm> 2023-07-28 10:27:46, 2023-07-28 09:13:03, 2023-07-28 10:‚Ä¶
    $ last_seen    <dttm> 2023-07-28 10:27:46, 2023-07-28 11:36:31, 2023-07-28 11:‚Ä¶
    $ duration_min <dbl> 0.00000, 143.46667, 69.06667, 76.28333, 70.40000, 76.3000‚Ä¶
    $ ap_count     <int> 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ‚Ä¶

1.  –û—Ü–µ–Ω–∏—Ç—å —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å —É—Ä–æ–≤–Ω—è —Å–∏–≥–Ω–∞–ª–∞ –≤–Ω—É—Ä–∏ –∫–ª–∞—Å—Ç–µ—Ä–∞ –≤–æ –≤—Ä–µ–º–µ–Ω–∏.
    –í—ã—è–≤–∏—Ç—å –Ω–∞–∏–±–æ–ª–µ–µ —Å—Ç–∞–±–∏–ª—å–Ω—ã–π –∫–ª–∞—Å—Ç–µ—Ä

``` r
wifi_clean <- wifi_clean %>%
  mutate(Power = as.numeric(Power))
```

    Warning: There was 1 warning in `mutate()`.
    ‚Ñπ In argument: `Power = as.numeric(Power)`.
    Caused by warning:
    ! NAs introduced by coercion

``` r
signal_stability <- wifi_clean %>%
  filter(!is.na(ESSID), !is.na(Power)) %>%
  group_by(ESSID) %>%
  summarise(
    mean_power = mean(Power),
    sd_power = sd(Power),
    observations = n(),
    .groups = "drop"
  ) %>%
  arrange(sd_power)

most_stable_cluster <- signal_stability %>%
  slice(1)

most_stable_cluster
```

    # A tibble: 1 √ó 4
      ESSID              mean_power sd_power observations
      <chr>                   <dbl>    <dbl>        <int>
    1 iPhone (–ê–Ω–∞—Å—Ç–∞—Å–∏—è)        -66     1.41            2

## –û—Ü–µ–Ω–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞

–í —Ä–∞–º–∫–∞—Ö –ø—Ä–∞–∫—Ç—á–µ—Å–∫–æ–π —Ä–∞–±–æ—Ç—ã –±—ã–ª–∞ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∞ —Ä–∞–¥–∏–æ—ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω–∞—è –æ–±—Å—Ç–∞–Ω–æ–≤–∫–∞
–∏ —Å–æ—Å—Ç–∞–≤–ª–µ–Ω–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –æ –º–µ—Ö–∞–Ω–∏–∑–º–∞—Ö —Ä–∞–±–æ—Ç—ã Wi-Fi —Å–µ—Ç–µ–π –Ω–∞ –∫–∞–Ω–∞–ª—å–Ω–æ–º
–∏ —Å–µ—Ç–µ–≤–æ–º —É—Ä–æ–≤–Ω–µ –º–æ–¥–µ–ª–∏ OSI

## –í—ã–≤–æ–¥

–í –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–π —Ä–∞–±–æ—Ç–µ –º—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏ –Ω–∞–≤—ã–∫–∏ –Ω–∞–ø–∏—Å–∞–Ω–∏—è –∫–æ–¥–∞ –Ω–∞ —è–∑—ã–∫–µ
–ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è R –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö –∏ –∑–∞–∫—Ä–µ–ø–∏–ª–∏ –∑–Ω–∞–Ω–∏—è –æ—Å–Ω–æ–≤–Ω—ã—Ö
—Ñ—É–Ω–∫—Ü–∏–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö —ç–∫–æ—Å–∏—Å—Ç–µ–º—ã tidyverse —è–∑—ã–∫–∞ R.
